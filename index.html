<!DOCTYPE html>
<html>
<meta charset=utf-8>
<title>Calcul des droits de douanes</title>

<style>
  html {
    font-family: helvetica;
    font-size: 18px;
    padding: 20px 0;
    background: #fff;
    line-height: 1.45em;
  }
  body {
    margin: 0;
  }

  input {
    font: inherit;
    border: 1px solid #999;
    padding: .2em .5em;
    border-radius: 5px;
  }

  header,
  main {
    max-width: 1000px;
    margin: 0 auto;
    padding: 0 5%;
  }

  header {
    display: flex;
    margin-bottom: 1em;
    align-items: center;
  }
  header img {
    max-height: 80px;
  }
  header h1 {
    margin-left: 2em;
    text-transform: uppercase;
    font-size: 18px;
    font-weight: normal;
    flex: 1;
  }
  header h1 span {
    font-weight: bold;
  }
  header a {
    text-decoration: none;
    cursor: pointer;
    color: #f99;
    text-align: right;
    width: 20%;
  }

  main {
    background: #ddd;
    padding: 2em 5%;
    text-align: center;
  }
  main h1,
  main h2 {
    font-weight: lighter;
  }
  main h1 {
    font-size: 1.4em;
  }
  main h2 {
    font-size: 1.3em;
  }
  button {
    font-size: 1em;
    padding: 20px 70px;
    background-color: #0275d8;
    border: 1px solid #ccc;
    border-radius: 5px;
    font-weight: normal;
    margin-right: 20px;
    color: #fff;
  }
  aside {
    border: 1px solid #999;
    margin: 1em auto;
    margin-top: 3em;
    padding: .5em .8em;
    width: 75%;
    min-width: 300px;
  }

  [data-page=amount] button,
  [data-page=warning] button {
    display: block;
    margin: 2em auto;
  }
  [data-page=warning] button {
    margin: 5em inherit;
  }

  button.unknown {
    background-color: #ec971f;
  }
  .satisfaction button {
    background-color: #5cb85c;
  }

  footer {
    text-align: center;
  }

  footer p {
    display: inline-block;
  }
  footer button {
    display: inline-block;
    padding: 5px 20px;
  }
  footer button:first-of-type {
    margin-left: 1.5em;
  }

</style>

<template id=warning>
  <h1>Bienvenue sur le prototype de « Calcul des droits de douane » pour estimer le montant des droits à payer pour l’achat en ligne d’un smartphone.</h1>

  <aside>
    <h2>Avertissement</h2>
    <p>
      L’information restituée (taux, montants) n’a qu’un caractère indicatif. La consultation des textes légaux et réglementaires sont les seuls à avoir force légale.<br>
      En poursuivant votre navigation sur ce site, vous acceptez l’utilisation de cookies nous permettant de suivre votre navigation ainsi que de réaliser des statistiques de visites.
    </p>
  </aside>
  <button data-href=origin>Commencer la simulation</button>
</template>

<template id=origin>
  <h1>Le vendeur expédie votre smartphone depuis un pays de l’Union européenne.</h1>
  <button data-href=duty-free>Oui</button>
  <button data-href=duty-20>Non</button>
  <button data-href=duty-unknown class=unknown>Je ne sais pas</button>
</template>

<template id=about>
  <h1>À propos du prototype</h1>
  <p>
    La direction générale des douanes et droits indirects propose un prototype dont la finalité est d’informer l’usager de France métropolitaine des taxes qu’il pourrait avoir à acquitter en cas d’achat à distance, notamment via des sites internet de ventes en ligne.
  </p>
  <p>
    S'appuyant sur les taux de TVA à acquitter en France ainsi que sur le tarif douanier commun des pays de l'Union europpéenne (droits de douane), l'information restituée (taux, montants) n'a qu'un caractère indicatif.
    En particulier le prototype ne traite pas de l'ensemble des mesures du commerce extérieur et de la totalité des taxes pouvant être appliquées.
  </p>
  <p>
     Les montants des droits et taxes calculés peuvent être différents de ceux réellement acquittés. La consultation des textes légaux et réglementaires, qui sont les seuls à avoir force légale, demeure impérative.
  </p>

  <button data-href=warning>Revenir à la simulation</button>
</template>

<template id=duty-free data-last>
  <h1>Pas de TVA et pas de droits de douane à payer.</h1>
  <p>
    L’envoi d’un <em>smartphone</em> depuis l’Union européenne est déjà soumis à la TVA au taux en vigueur dans le pays d’expédition et n’est pas assujetti aux droits de douane.
  </p>
</template>

<template id=duty-20 data-last>
  <h1>20% de TVA, pas de droits de douane.</h1>
  <p>
    L’envoi d’un <em>smartphone</em> depuis un pays non membre de l’Union européenne est soumis à la TVA de 20 %, mais pas à des droits de douane.
  </p>
</template>

<template id=duty-unknown data-last>
  <h1>0% ou 20% de TVA, pas de droits de douane.</h1>
  <p>
L’envoi d’un <em>smartphone</em> depuis l’Union européenne est déjà soumis à la TVA au taux en vigueur dans le pays d’expédition et n’est pas assujetti aux droits de douane.<br/>
    L’envoi d’un <em>smartphone</em> depuis un pays non membre de l’Union européenne est soumis à la TVA de 20 %, mais pas à des droits de douane.
  </p>
</template>

<template id=end>
  <h1>Fin de la simulation</h1>
  <p>
    Merci de votre retour.
  </p>
  <p>
    <button data-href=warning>Recommencer</button>
  </p>
</template>

<template id=satisfaction>
  <p>Cette réponse vous est-elle utile ?</p>
  <button data-href=end>Oui</button>
  <button data-href=end>Non</button>
</template>

<header>
  <img src=./images/logo.png>
  <h1><span>Calcul</span> des droits et taxes</h1>
  <a data-href=about>À propos du prototype</a>
</header>

<main id=container></main>
<footer></footer>

<script>
  var container = document.querySelector('#container')
  var footer = document.querySelector('footer')

  function showPage (page) {
    var source = document.querySelector('#' + page)
    container.innerHTML = source.innerHTML
    container.setAttribute('data-page', page)
    var withSatisfaction = source.hasAttribute('data-last')
    if (withSatisfaction) {
      footer.innerHTML = document.querySelector('#satisfaction').innerHTML
      footer.classList.add('satisfaction')
    }
    else if(footer.classList.contains('satisfaction')) {
      footer.innerHTML = ''
      footer.classList.remove('satisfaction')
    }
    initListerners(document.body)
  }

  function initListerners (element) {
    ;[].forEach.call(element.querySelectorAll('[data-href]'), function (button) {
      button.addEventListener('click', function (event) {
        showPage(button.getAttribute('data-href'))
      })
    })
  }

  showPage('warning')
</script>
</html>
